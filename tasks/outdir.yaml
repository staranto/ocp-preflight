---
- block:
<<<<<<< HEAD
    - name: "Confirm that {{ outdir }}/{{ clusterName }} directories exists"
      file:
        path: "{{ outdir }}/{{ clusterName }}/{{ item }}"
        state: directory
      loop:
        - archive
        - artifacts
        - www
=======
    - name: "Confirm that {{ outdir }}/{{ clusterName }} directories exist"
      file:
        path: "{{ item }}"
        state: directory
      loop:
        - "{{ outdir }}/{{ clusterName }}/archive"
        - "{{ outdir }}/{{ clusterName }}/artifacts"
>>>>>>> 6e36f170f66678c7c8057407b53a8d1a2272631b

    - stat:
        path: "{{ outdir }}/{{ clusterName }}/artifacts/install-config.yaml"
      register: s

    - name: "Archive existing artifacts"
      archive:
        path: "{{ outdir }}/{{ clusterName }}/artifacts"
        dest: "{{ outdir }}/{{ clusterName }}/archive/{{ '%Y%m%d-%H%M' | strftime(s.stat.mtime) }}.tar.gz"
        exclude_path:
        - "{{ outdir }}/{{ clusterName }}/archive"
        remove: yes
      when: s.stat.exists is defined and s.stat.exists
  tags: [ always ]
<<<<<<< HEAD


=======
>>>>>>> 6e36f170f66678c7c8057407b53a8d1a2272631b
...
